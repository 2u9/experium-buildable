//Deobfuscated with https://github.com/SimplyProgrammer/Minecraft-Deobfuscator3000 using mappings "C:\Users\Luni\Documents\1.12 stable mappings"!

// 
// Decompiled by Procyon v0.5.36
// 

package dev._3000IQPlay.experium.features.modules.exploit;

import dev._3000IQPlay.experium.util.BlockUtil;
import net.minecraft.util.EnumHand;
import net.minecraft.network.Packet;
import net.minecraft.util.EnumFacing;
import net.minecraft.network.play.client.CPacketPlayerDigging;
import net.minecraft.item.ItemAxe;
import net.minecraft.util.math.BlockPos;
import java.util.Iterator;
import dev._3000IQPlay.experium.util.InventoryUtil;
import net.minecraft.item.ItemSign;
import dev._3000IQPlay.experium.features.command.Command;
import dev._3000IQPlay.experium.util.MathUtil;
import net.minecraft.tileentity.TileEntitySign;
import net.minecraft.tileentity.TileEntity;
import dev._3000IQPlay.experium.util.Timer;
import dev._3000IQPlay.experium.features.setting.Setting;
import dev._3000IQPlay.experium.features.modules.Module;

public class AutoSignKick extends Module
{
    public Setting<Integer> switchDelay;
    public Setting<Integer> placeDelay;
    public Setting<Integer> mineDelay;
    public Setting<Integer> range;
    Timer placeTimer;
    Timer switchTimer;
    Timer mineTimer;
    private boolean hadBreak;
    
    public AutoSignKick() {
        super("AutoSignKick", "stop being lazy lmao", Category.EXPLOIT, true, false, false);
        this.switchDelay = (Setting<Integer>)this.register(new Setting("SwitchDelay", (T)100, (T)0, (T)5000));
        this.placeDelay = (Setting<Integer>)this.register(new Setting("PlaceDelay", (T)100, (T)0, (T)5000));
        this.mineDelay = (Setting<Integer>)this.register(new Setting("MineDelay", (T)100, (T)0, (T)5000));
        this.range = (Setting<Integer>)this.register(new Setting("Range", (T)2, (T)1, (T)20));
        this.placeTimer = new Timer();
        this.switchTimer = new Timer();
        this.mineTimer = new Timer();
    }
    
    @Override
    public void onEnable() {
        this.hadBreak = false;
    }
    
    @Override
    public void onDisable() {
        this.hadBreak = false;
    }
    
    @Override
    public void onUpdate() {
        for (final TileEntity tileEntity : AutoSignKick.mc.world.loadedTileEntityList) {
            if (!(tileEntity instanceof TileEntitySign)) {
                continue;
            }
            if (AutoSignKick.mc.player.getDistanceSq(tileEntity.getPos()) > MathUtil.square(this.range.getValue())) {
                continue;
            }
            Command.sendMessage("Sign located at X: " + tileEntity.getPos().getX() + ", Y: " + tileEntity.getPos().getY() + ", Z: " + tileEntity.getPos().getZ());
            final BlockPos posTile = tileEntity.getPos();
            if (this.hadBreak) {
                continue;
            }
            this.axeSwitch();
            this.mineBlock(posTile);
            InventoryUtil.switchToHotbarSlot(ItemSign.class, false);
            Command.sendMessage("Changed to sign hotbar.");
            this.switchTimer.reset();
            this.place(posTile);
            Command.sendMessage("Done!");
            this.disable();
            this.hadBreak = true;
        }
    }
    
    private void axeSwitch() {
        if (this.switchTimer.passedMs(this.switchDelay.getValue() * 3L)) {
            InventoryUtil.switchToHotbarSlot(ItemAxe.class, false);
            Command.sendMessage("Switched to Axe");
            this.switchTimer.reset();
        }
    }
    
    private void mineBlock(final BlockPos pos) {
        if (this.mineTimer.passedMs(this.mineDelay.getValue() * 3L)) {
            AutoSignKick.mc.player.connection.sendPacket((Packet)new CPacketPlayerDigging(CPacketPlayerDigging.Action.START_DESTROY_BLOCK, pos, EnumFacing.UP));
            Command.sendMessage("Mined");
            this.mineTimer.reset();
        }
    }
    
    private void place(final BlockPos pos) {
        if (this.placeTimer.passedMs(this.placeDelay.getValue() * 3L)) {
            BlockUtil.placeBlockSmartRotate(pos, EnumHand.MAIN_HAND, true, true, false);
            Command.sendMessage("Placed sign!");
            this.placeTimer.reset();
        }
    }
}
