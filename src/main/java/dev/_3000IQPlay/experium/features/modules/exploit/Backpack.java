//Deobfuscated with https://github.com/SimplyProgrammer/Minecraft-Deobfuscator3000 using mappings "C:\Users\Luni\Documents\1.12 stable mappings"!

// 
// Decompiled by Procyon v0.5.36
// 

package dev._3000IQPlay.experium.features.modules.exploit;

import dev._3000IQPlay.experium.features.gui.ExperiumGui;
import net.minecraft.client.gui.inventory.GuiContainer;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;
import net.minecraft.network.play.client.CPacketCloseWindow;
import dev._3000IQPlay.experium.features.Feature;
import dev._3000IQPlay.experium.event.events.PacketEvent;
import net.minecraft.client.gui.GuiScreen;
import dev._3000IQPlay.experium.features.setting.Setting;
import dev._3000IQPlay.experium.features.modules.Module;

public class Backpack extends Module
{
    public Setting<Boolean> open;
    public Setting<Boolean> close;
    private GuiScreen cancelledGui;
    
    public Backpack() {
        super("Backpack", "Manipulates container packets", Category.EXPLOIT, true, false, false);
        this.open = (Setting<Boolean>)this.register(new Setting("Open", (T)false));
        this.close = (Setting<Boolean>)this.register(new Setting("Close", (T)false));
        this.cancelledGui = null;
    }
    
    @SubscribeEvent
    public void onPacketSend(final PacketEvent.Send e) {
        if (Feature.fullNullCheck() || this.isDisabled()) {
            return;
        }
        if (e.getPacket() instanceof CPacketCloseWindow && this.close.getValue()) {
            e.setCanceled(true);
        }
    }
    
    @Override
    public void onUpdate() {
        if (this.isDisabled()) {
            return;
        }
        if (Backpack.mc.currentScreen instanceof GuiContainer && this.open.getValue()) {
            if (Backpack.mc.currentScreen instanceof ExperiumGui) {
                return;
            }
            this.cancelledGui = Backpack.mc.currentScreen;
            Backpack.mc.currentScreen = null;
        }
    }
    
    @Override
    public void onDisable() {
        if (!Feature.fullNullCheck() && this.cancelledGui != null && this.open.getValue()) {
            Backpack.mc.displayGuiScreen(this.cancelledGui);
        }
        this.cancelledGui = null;
    }
}
